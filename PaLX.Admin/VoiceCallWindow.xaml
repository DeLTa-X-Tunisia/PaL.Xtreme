<Window x:Class="PaLX.Admin.VoiceCallWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Appel Vocal" Height="500" Width="400"
        WindowStyle="None" ResizeMode="NoResize" Background="#1E1E1E"
        WindowStartupLocation="CenterScreen" Topmost="True"
        MouseDown="Window_MouseDown">
    <Border BorderBrush="#333" BorderThickness="1" CornerRadius="10">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Participants List -->
            <ItemsControl x:Name="ParticipantsList" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,20,0,20">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Margin="10">
                            <Ellipse Width="80" Height="80" Margin="0,0,0,10">
                                <Ellipse.Fill>
                                    <ImageBrush ImageSource="{Binding AvatarPath, TargetNullValue='/Assets/default_avatar.png'}" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock Text="{Binding DisplayName}" Foreground="White" FontSize="14" FontWeight="Bold" HorizontalAlignment="Center" TextAlignment="Center" TextWrapping="Wrap" MaxWidth="100"/>
                        </StackPanel>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <StackPanel Grid.Row="1" VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="20">
                <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="100" Margin="0,0,0,10">
                    <TextBlock x:Name="StatusText" Text="Appel en cours..." Foreground="#CCC" FontSize="12" HorizontalAlignment="Center" TextWrapping="Wrap" TextAlignment="Center"/>
                </ScrollViewer>
                <TextBlock x:Name="TimerText" Text="00:00" Foreground="#AAA" FontSize="14" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                
                <!-- Incoming Call Controls -->
                <StackPanel x:Name="IncomingControls" Orientation="Horizontal" HorizontalAlignment="Center" Visibility="Collapsed">
                    <Button x:Name="AcceptBtn" Content="ðŸ“ž" Width="50" Height="50" Click="AcceptBtn_Click" Background="#4CAF50" Foreground="White" BorderThickness="0" FontSize="20" Margin="0,0,20,0">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="25"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                    <Button x:Name="DeclineBtn" Content="âŒ" Width="50" Height="50" Click="DeclineBtn_Click" Background="#F44336" Foreground="White" BorderThickness="0" FontSize="20">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="25"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                </StackPanel>

                <!-- Active Call Controls -->
                <StackPanel x:Name="ActiveControls" Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button x:Name="InviteBtn" Content="âž•" Width="50" Height="50" Click="InviteBtn_Click" Background="#2196F3" Foreground="White" BorderThickness="0" FontSize="20" Margin="0,0,20,0" ToolTip="Inviter un ami">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="25"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                    <Button x:Name="MuteBtn" Content="ðŸŽ™ï¸" Width="50" Height="50" Click="MuteBtn_Click" Background="#444" Foreground="White" BorderThickness="0" FontSize="20" Margin="0,0,20,0">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="25"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                    <Button x:Name="EndCallBtn" Content="ðŸ“ž" Width="50" Height="50" Click="EndCallBtn_Click" Background="#F44336" Foreground="White" BorderThickness="0" FontSize="20" RenderTransformOrigin="0.5,0.5">
                        <Button.RenderTransform>
                            <RotateTransform Angle="135"/>
                        </Button.RenderTransform>
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="25"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                </StackPanel>
            </StackPanel>
        </Grid>
    </Border>
</Window>